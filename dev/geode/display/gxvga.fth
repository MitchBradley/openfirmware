purpose: Put the Geode display in VGA mode to use text mode 3
\ See license at end of file

hex
create hfilter
1284A7D5 , 000017D5 ,          \  -43,  297,  296,  -43,    5
12A497D7 , 000013D6 ,          \  -41,  293,  298,  -42,    4
12D48BD7 , 000013D6 ,          \  -41,  290,  301,  -42,    4
13147FD7 , 000013D5 ,          \  -41,  287,  305,  -43,    4
133473D8 , 000013D5 ,          \  -40,  284,  307,  -43,    4
136467D8 , 000013D5 ,          \  -40,  281,  310,  -43,    4
13945FD8 , 000013D4 ,          \  -40,  279,  313,  -44,    4
13B453D9 , 000013D4 ,          \  -39,  276,  315,  -44,    4
13E447D9 , 000013D4 ,          \  -39,  273,  318,  -44,    4
14143BDA , 000013D3 ,          \  -38,  270,  321,  -45,    4
143433DA , 000013D3 ,          \  -38,  268,  323,  -45,    4
146427DA , 000013D3 ,          \  -38,  265,  326,  -45,    4
14941BDB , 000013D2 ,          \  -37,  262,  329,  -46,    4
14C40FDB , 000013D2 ,          \  -37,  259,  332,  -46,    4
14F407DA , 000017D1 ,          \  -38,  257,  335,  -47,    5
1503FBDC , 000013D2 ,          \  -36,  254,  336,  -46,    4
1543F3DB , 000017D0 ,          \  -37,  252,  340,  -48,    5
1563E3DD , 000013D1 ,          \  -35,  248,  342,  -47,    4
1593D7DD , 000013D1 ,          \  -35,  245,  345,  -47,    4
15B3CFDD , 000013D1 ,          \  -35,  243,  347,  -47,    4
15E3C3DE , 000013D0 ,          \  -34,  240,  350,  -48,    4
1613B7DE , 000013D0 ,          \  -34,  237,  353,  -48,    4
1633ABDF , 000013D0 ,          \  -33,  234,  355,  -48,    4
16639FDF , 000013D0 ,          \  -33,  231,  358,  -48,    4
167397E0 , 000013D0 ,          \  -32,  229,  359,  -48,    4
16B38BE0 , 000013CF ,          \  -32,  226,  363,  -49,    4
16E383DF , 000017CE ,          \  -33,  224,  366,  -50,    5
170373E1 , 000013CF ,          \  -31,  220,  368,  -49,    4
17236BE1 , 000013CF ,          \  -31,  218,  370,  -49,    4
17435FE2 , 000013CF ,          \  -30,  215,  372,  -49,    4
177353E2 , 000013CF ,          \  -30,  212,  375,  -49,    4
17B34BE1 , 000017CD ,          \  -31,  210,  379,  -51,    5
17C33FE3 , 000013CE ,          \  -29,  207,  380,  -50,    4
17F333E3 , 000013CE ,          \  -29,  204,  383,  -50,    4
181327E4 , 000013CE ,          \  -28,  201,  385,  -50,    4
18431FE3 , 000017CD ,          \  -29,  199,  388,  -51,    5
186313E4 , 000013CE ,          \  -28,  196,  390,  -50,    4
188307E5 , 000013CE ,          \  -27,  193,  392,  -50,    4
18B2FBE5 , 000013CE ,          \  -27,  190,  395,  -50,    4
18C2F3E6 , 000013CE ,          \  -26,  188,  396,  -50,    4
18F2E7E6 , 000013CE ,          \  -26,  185,  399,  -50,    4
1912DBE7 , 000013CE ,          \  -25,  182,  401,  -50,    4
1952D3E6 , 000017CC ,          \  -26,  180,  405,  -52,    5
1972CBE6 , 000017CC ,          \  -26,  178,  407,  -52,    5
1992BFE7 , 000017CC ,          \  -25,  175,  409,  -52,    5
19C2B3E7 , 000017CC ,          \  -25,  172,  412,  -52,    5
19D2A7E9 , 000013CD ,          \  -23,  169,  413,  -51,    4
1A029FE8 , 000017CC ,          \  -24,  167,  416,  -52,    5
1A1293E9 , 000013CE ,          \  -23,  164,  417,  -50,    4
1A3287EA , 000013CE ,          \  -22,  161,  419,  -50,    4
1A627FE9 , 000017CD ,          \  -23,  159,  422,  -51,    5
1A7273EB , 000013CE ,          \  -21,  156,  423,  -50,    4
1AA267EB , 000013CE ,          \  -21,  153,  426,  -50,    4
1AC25FEB , 000013CE ,          \  -21,  151,  428,  -50,    4
1AE253EC , 000013CE ,          \  -20,  148,  430,  -50,    4
1B124BEB , 000017CD ,          \  -21,  146,  433,  -51,    5
1B223FED , 000013CE ,          \  -19,  143,  434,  -50,    4
1B5237EC , 000017CD ,          \  -20,  141,  437,  -51,    5
1B622BED , 000013CF ,          \  -19,  138,  438,  -49,    4
1B821FEE , 000013CF ,          \  -18,  135,  440,  -49,    4
1BA217EE , 000013CF ,          \  -18,  133,  442,  -49,    4
1BC20BEF , 000013CF ,          \  -17,  130,  444,  -49,    4
1BE203EF , 000013CF ,          \  -17,  128,  446,  -49,    4
1C01FBEE , 000017CF ,          \  -18,  126,  448,  -49,    5
1C11EFF0 , 000013D0 ,          \  -16,  123,  449,  -48,    4
1C41E7EF , 000017CF ,          \  -17,  121,  452,  -49,    5
1C61DFEF , 000017CF ,          \  -17,  119,  454,  -49,    5
1C61D3F1 , 000013D1 ,          \  -15,  116,  454,  -47,    4
1C91CBF0 , 000017D0 ,          \  -16,  114,  457,  -48,    5
1CA1BFF2 , 000013D1 ,          \  -14,  111,  458,  -47,    4
1CC1B3F2 , 000013D2 ,          \  -14,  108,  460,  -46,    4
1CE1AFF1 , 000017D1 ,          \  -15,  107,  462,  -47,    5
1CF1A3F3 , 000013D2 ,          \  -13,  104,  463,  -46,    4
1D1197F3 , 000013D3 ,          \  -13,  101,  465,  -45,    4
1D3197F2 , 000013D2 ,          \  -14,  101,  467,  -46,    4
1D518BF3 , 000013D2 ,          \  -13,   98,  469,  -46,    4
1D6183F3 , 000013D3 ,          \  -13,   96,  470,  -45,    4
1D817BF3 , 000013D3 ,          \  -13,   94,  472,  -45,    4
1D916FF4 , 000013D4 ,          \  -12,   91,  473,  -44,    4
1DB167F4 , 000013D4 ,          \  -12,   89,  475,  -44,    4
1DC15FF4 , 000013D5 ,          \  -12,   87,  476,  -43,    4
1DE153F5 , 000013D5 ,          \  -11,   84,  478,  -43,    4
1DF14BF5 , 000013D6 ,          \  -11,   82,  479,  -42,    4
1E1143F5 , 000013D6 ,          \  -11,   80,  481,  -42,    4
1E1137F7 , 00000FD8 ,          \   -9,   77,  481,  -40,    3
1E3133F6 , 000013D7 ,          \  -10,   76,  483,  -41,    4
1E412BF6 , 000013D8 ,          \  -10,   74,  484,  -40,    4
1E611FF7 , 000013D8 ,          \   -9,   71,  486,  -40,    4
1E7117F7 , 000013D9 ,          \   -9,   69,  487,  -39,    4
1E810FF7 , 000013DA ,          \   -9,   67,  488,  -38,    4
1E9107F8 , 000013DA ,          \   -8,   65,  489,  -38,    4
1EA0FFF8 , 000013DB ,          \   -8,   63,  490,  -37,    4
1EB0F3F9 , 00000FDD ,          \   -7,   60,  491,  -35,    3
1ED0EFF8 , 000013DC ,          \   -8,   59,  493,  -36,    4
1EE0E7F9 , 00000FDD ,          \   -7,   57,  494,  -35,    3
1EF0DFF9 , 00000FDE ,          \   -7,   55,  495,  -34,    3
1F00D7F9 , 00000FDF ,          \   -7,   53,  496,  -33,    3
1F10CFFA , 00000FDF ,          \   -6,   51,  497,  -33,    3
1F20C7FA , 00000FE0 ,          \   -6,   49,  498,  -32,    3
1F20C3FA , 00000FE1 ,          \   -6,   48,  498,  -31,    3
1F30BBFA , 00000FE2 ,          \   -6,   46,  499,  -30,    3
1F40AFFB , 00000FE3 ,          \   -5,   43,  500,  -29,    3
1F50A7FB , 00000FE4 ,          \   -5,   41,  501,  -28,    3
1F60A3FB , 00000FE4 ,          \   -5,   40,  502,  -28,    3
1F709BFB , 00000FE5 ,          \   -5,   38,  503,  -27,    3
1F7093FC , 00000FE6 ,          \   -4,   36,  503,  -26,    3
1F808FFC , 00000BE7 ,          \   -4,   35,  504,  -25,    2
1F9087FC , 00000BE8 ,          \   -4,   33,  505,  -24,    2
1F9083FC , 00000BE9 ,          \   -4,   32,  505,  -23,    2
1FA077FD , 00000BEA ,          \   -3,   29,  506,  -22,    2
1FA073FD , 00000BEB ,          \   -3,   28,  506,  -21,    2
1FB06BFD , 00000BEC ,          \   -3,   26,  507,  -20,    2
1FC063FD , 00000BED ,          \   -3,   24,  508,  -19,    2
1FC05BFE , 00000BEE ,          \   -2,   22,  508,  -18,    2
1FC057FE , 00000BEF ,          \   -2,   21,  508,  -17,    2
1FD053FE , 000007F0 ,          \   -2,   20,  509,  -16,    1
1FD04BFE , 000007F2 ,          \   -2,   18,  509,  -14,    1
1FE043FE , 000007F3 ,          \   -2,   16,  510,  -13,    1
1FE03BFF , 000007F4 ,          \   -1,   14,  510,  -12,    1
1FE037FF , 000007F5 ,          \   -1,   13,  510,  -11,    1
1FE033FF , 000007F6 ,          \   -1,   12,  510,  -10,    1
1FF02BFF , 000007F7 ,          \   -1,   10,  511,   -9,    1
1FF027FF , 000003F9 ,          \   -1,    9,  511,   -7,    0
1FF01C00 , 000003FA ,          \    0,    7,  511,   -6,    0
1FF01800 , 000003FB ,          \    0,    6,  511,   -5,    0
1FF01400 , 000003FC ,          \    0,    5,  511,   -4,    0
1FF00C00 , 000003FE ,          \    0,    3,  511,   -2,    0
1FF00800 , 000003FF ,          \    0,    2,  511,   -1,    0
1FF00400 , 00000000 ,          \    0,    1,  511,    0,    0
1FFFFC00 , 00000002 ,          \    0,   -1,  511,    2,    0
1FFFF800 , 00000003 ,          \    0,   -2,  511,    3,    0
1FFFF000 , 00000005 ,          \    0,   -4,  511,    5,    0
1FFFEC00 , 00000006 ,          \    0,   -5,  511,    6,    0
1FFFE800 , 00000007 ,          \    0,   -6,  511,    7,    0
1FFFE400 , 000FFC09 ,          \    0,   -7,  511,    9,   -1
1FFFDC01 , 000FFC0A ,          \    1,   -9,  511,   10,   -1
1FEFDC01 , 000FFC0B ,          \    1,   -9,  510,   11,   -1
1FEFD401 , 000FFC0D ,          \    1,  -11,  510,   13,   -1
1FEFD001 , 000FFC0E ,          \    1,  -12,  510,   14,   -1
1FEFCC01 , 000FF810 ,          \    1,  -13,  510,   16,   -2
1FDFCC01 , 000FF811 ,          \    1,  -13,  509,   17,   -2
1FDFC401 , 000FF813 ,          \    1,  -15,  509,   19,   -2
1FCFC002 , 000FF814 ,          \    2,  -16,  508,   20,   -2
1FCFB802 , 000FF816 ,          \    2,  -18,  508,   22,   -2
1FCFB402 , 000FF418 ,          \    2,  -19,  508,   24,   -3
1FBFB402 , 000FF419 ,          \    2,  -19,  507,   25,   -3
1FAFB002 , 000FF41B ,          \    2,  -20,  506,   27,   -3
1FAFA802 , 000FF41D ,          \    2,  -22,  506,   29,   -3
1F9FA802 , 000FF01F ,          \    2,  -22,  505,   31,   -4
1F9FA402 , 000FF020 ,          \    2,  -23,  505,   32,   -4
1F8FA002 , 000FF022 ,          \    2,  -24,  504,   34,   -4
1F7F9803 , 000FF024 ,          \    3,  -26,  503,   36,   -4
1F7F9403 , 000FEC26 ,          \    3,  -27,  503,   38,   -5
1F6F9003 , 000FEC28 ,          \    3,  -28,  502,   40,   -5
1F5F9003 , 000FEC29 ,          \    3,  -28,  501,   41,   -5
1F4F8C03 , 000FEC2B ,          \    3,  -29,  500,   43,   -5
1F3F8C03 , 000FE82D ,          \    3,  -29,  499,   45,   -6
1F2F8803 , 000FE82F ,          \    3,  -30,  498,   47,   -6
1F2F8003 , 000FE831 ,          \    3,  -32,  498,   49,   -6
1F1F7C03 , 000FE833 ,          \    3,  -33,  497,   51,   -6
1F0F7C03 , 000FE435 ,          \    3,  -33,  496,   53,   -7
1EFF7803 , 000FE437 ,          \    3,  -34,  495,   55,   -7
1EEF7403 , 000FE439 ,          \    3,  -35,  494,   57,   -7
1EDF7004 , 000FE03B ,          \    4,  -36,  493,   59,   -8
1EBF7403 , 000FE43C ,          \    3,  -35,  491,   60,   -7
1EAF6C04 , 000FE03F ,          \    4,  -37,  490,   63,   -8
1E9F6804 , 000FE041 ,          \    4,  -38,  489,   65,   -8
1E8F6804 , 000FDC43 ,          \    4,  -38,  488,   67,   -9
1E7F6404 , 000FDC45 ,          \    4,  -39,  487,   69,   -9
1E6F6004 , 000FDC47 ,          \    4,  -40,  486,   71,   -9
1E4F6404 , 000FD849 ,          \    4,  -39,  484,   73,  -10
1E3F6004 , 000FD84B ,          \    4,  -40,  483,   75,  -10
1E1F6003 , 000FDC4D ,          \    3,  -40,  481,   77,   -9
1E1F5804 , 000FD450 ,          \    4,  -42,  481,   80,  -11
1DFF5804 , 000FD452 ,          \    4,  -42,  479,   82,  -11
1DEF5404 , 000FD454 ,          \    4,  -43,  478,   84,  -11
1DCF5804 , 000FD056 ,          \    4,  -42,  476,   86,  -12
1DBF5004 , 000FD059 ,          \    4,  -44,  475,   89,  -12
1D9F5004 , 000FD05B ,          \    4,  -44,  473,   91,  -12
1D8F5004 , 000FCC5D ,          \    4,  -44,  472,   93,  -13
1D6F5004 , 000FCC5F ,          \    4,  -44,  470,   95,  -13
1D5F4804 , 000FCC62 ,          \    4,  -46,  469,   98,  -13
1D3F4C04 , 000FC864 ,          \    4,  -45,  467,  100,  -14
1D1F4C04 , 000FCC65 ,          \    4,  -45,  465,  101,  -13
1CFF4804 , 000FCC68 ,          \    4,  -46,  463,  104,  -13
1CEF4405 , 000FC46B ,          \    5,  -47,  462,  107,  -15
1CCF4804 , 000FC86C ,          \    4,  -46,  460,  108,  -14
1CAF4404 , 000FC86F ,          \    4,  -47,  458,  111,  -14
1C9F4005 , 000FC072 ,          \    5,  -48,  457,  114,  -16
1C6F4404 , 000FC474 ,          \    4,  -47,  454,  116,  -15
1C6F3C05 , 000FBC77 ,          \    5,  -49,  454,  119,  -17
1C4F3C05 , 000FBC79 ,          \    5,  -49,  452,  121,  -17
1C1F4004 , 000FC07B ,          \    4,  -48,  449,  123,  -16
1C0F3C05 , 000FB87E ,          \    5,  -49,  448,  126,  -18
1BEF3C04 , 000FBC80 ,          \    4,  -49,  446,  128,  -17
1BCF3C04 , 000FBC82 ,          \    4,  -49,  444,  130,  -17
1BAF3C04 , 000FB885 ,          \    4,  -49,  442,  133,  -18
1B8F3C04 , 000FB887 ,          \    4,  -49,  440,  135,  -18
1B6F3C04 , 000FB48A ,          \    4,  -49,  438,  138,  -19
1B5F3405 , 000FB08D ,          \    5,  -51,  437,  141,  -20
1B2F3804 , 000FB48F ,          \    4,  -50,  434,  143,  -19
1B1F3405 , 000FAC92 ,          \    5,  -51,  433,  146,  -21
1AEF3804 , 000FB094 ,          \    4,  -50,  430,  148,  -20
1ACF3804 , 000FAC97 ,          \    4,  -50,  428,  151,  -21
1AAF3804 , 000FAC99 ,          \    4,  -50,  426,  153,  -21
1A7F3804 , 000FAC9C ,          \    4,  -50,  423,  156,  -21
1A6F3405 , 000FA49F ,          \    5,  -51,  422,  159,  -23
1A3F3804 , 000FA8A1 ,          \    4,  -50,  419,  161,  -22
1A1F3804 , 000FA4A4 ,          \    4,  -50,  417,  164,  -23
1A0F3005 , 000FA0A7 ,          \    5,  -52,  416,  167,  -24
19DF3404 , 000FA4A9 ,          \    4,  -51,  413,  169,  -23
19CF3005 , 000F9CAC ,          \    5,  -52,  412,  172,  -25
199F3005 , 000F9CAF ,          \    5,  -52,  409,  175,  -25
197F3005 , 000F98B2 ,          \    5,  -52,  407,  178,  -26
195F3005 , 000F98B4 ,          \    5,  -52,  405,  180,  -26
191F3804 , 000F9CB6 ,          \    4,  -50,  401,  182,  -25
18FF3804 , 000F98B9 ,          \    4,  -50,  399,  185,  -26
18CF3804 , 000F98BC ,          \    4,  -50,  396,  188,  -26
18BF3804 , 000F94BE ,          \    4,  -50,  395,  190,  -27
188F3804 , 000F94C1 ,          \    4,  -50,  392,  193,  -27
186F3804 , 000F90C4 ,          \    4,  -50,  390,  196,  -28
184F3405 , 000F8CC7 ,          \    5,  -51,  388,  199,  -29
181F3804 , 000F90C9 ,          \    4,  -50,  385,  201,  -28
17FF3804 , 000F8CCC ,          \    4,  -50,  383,  204,  -29
17CF3804 , 000F8CCF ,          \    4,  -50,  380,  207,  -29
17BF3405 , 000F84D2 ,          \    5,  -51,  379,  210,  -31
177F3C04 , 000F88D4 ,          \    4,  -49,  375,  212,  -30
174F3C04 , 000F88D7 ,          \    4,  -49,  372,  215,  -30
172F3C04 , 000F84DA ,          \    4,  -49,  370,  218,  -31
170F3C04 , 000F84DC ,          \    4,  -49,  368,  220,  -31
16EF3805 , 000F7CE0 ,          \    5,  -50,  366,  224,  -33
16BF3C04 , 000F80E2 ,          \    4,  -49,  363,  226,  -32
167F4004 , 000F80E5 ,          \    4,  -48,  359,  229,  -32
166F4004 , 000F7CE7 ,          \    4,  -48,  358,  231,  -33
163F4004 , 000F7CEA ,          \    4,  -48,  355,  234,  -33
161F4004 , 000F78ED ,          \    4,  -48,  353,  237,  -34
15EF4004 , 000F78F0 ,          \    4,  -48,  350,  240,  -34
15BF4404 , 000F74F3 ,          \    4,  -47,  347,  243,  -35
159F4404 , 000F74F5 ,          \    4,  -47,  345,  245,  -35
156F4404 , 000F74F8 ,          \    4,  -47,  342,  248,  -35
154F4005 , 000F6CFC ,          \    5,  -48,  340,  252,  -37
150F4804 , 000F70FE ,          \    4,  -46,  336,  254,  -36
14FF4405 , 000F6901 ,          \    5,  -47,  335,  257,  -38
14CF4804 , 000F6D03 ,          \    4,  -46,  332,  259,  -37
149F4804 , 000F6D06 ,          \    4,  -46,  329,  262,  -37
146F4C04 , 000F6909 ,          \    4,  -45,  326,  265,  -38
143F4C04 , 000F690C ,          \    4,  -45,  323,  268,  -38
141F4C04 , 000F690E ,          \    4,  -45,  321,  270,  -38
13EF5004 , 000F6511 ,          \    4,  -44,  318,  273,  -39
13BF5004 , 000F6514 ,          \    4,  -44,  315,  276,  -39
139F5004 , 000F6117 ,          \    4,  -44,  313,  279,  -40
136F5404 , 000F6119 ,          \    4,  -43,  310,  281,  -40
133F5404 , 000F611C ,          \    4,  -43,  307,  284,  -40
131F5404 , 000F5D1F ,          \    4,  -43,  305,  287,  -41
12DF5C04 , 000F5D21 ,          \    4,  -41,  301,  289,  -41
12AF5C04 , 000F5D24 ,          \    4,  -41,  298,  292,  -41

create vfilter
3F840D05 ,                        \ 261, 259,  -8
3F841D01 ,                        \ 257, 263,  -8
3F8428FE ,                        \ 254, 266,  -8
3F8438FA ,                        \ 250, 270,  -8
3F8444F7 ,                        \ 247, 273,  -8
3F8450F4 ,                        \ 244, 276,  -8
3F845CF1 ,                        \ 241, 279,  -8
3F8468EE ,                        \ 238, 282,  -8
3F8474EB ,                        \ 235, 285,  -8
3F8480E8 ,                        \ 232, 288,  -8
3F7490E5 ,                        \ 229, 292,  -9
3F749CE2 ,                        \ 226, 295,  -9
3F74ACDE ,                        \ 222, 299,  -9
3F74B8DB ,                        \ 219, 302,  -9
3F74C0D9 ,                        \ 217, 304,  -9
3F74CCD6 ,                        \ 214, 307,  -9
3F74D8D3 ,                        \ 211, 310,  -9
3F74E8CF ,                        \ 207, 314,  -9
3F74F4CC ,                        \ 204, 317,  -9
3F7500C9 ,                        \ 201, 320,  -9
3F750CC6 ,                        \ 198, 323,  -9
3F7518C3 ,                        \ 195, 326,  -9
3F7520C1 ,                        \ 193, 328,  -9
3F7530BD ,                        \ 189, 332,  -9
3F753CBA ,                        \ 186, 335,  -9
3F7548B7 ,                        \ 183, 338,  -9
3F6558B4 ,                        \ 180, 342, -10
3F6560B2 ,                        \ 178, 344, -10
3F656CAF ,                        \ 175, 347, -10
3F6578AC ,                        \ 172, 350, -10
3F6584A9 ,                        \ 169, 353, -10
3F658CA7 ,                        \ 167, 355, -10
3F6598A4 ,                        \ 164, 358, -10
3F65A8A0 ,                        \ 160, 362, -10
3F65B09E ,                        \ 158, 364, -10
3F65BC9B ,                        \ 155, 367, -10
3F65C499 ,                        \ 153, 369, -10
3F65D096 ,                        \ 150, 372, -10
3F55E093 ,                        \ 147, 376, -11
3F55E891 ,                        \ 145, 378, -11
3F55F48E ,                        \ 142, 381, -11
3F56008B ,                        \ 139, 384, -11
3F560C88 ,                        \ 136, 387, -11
3F561486 ,                        \ 134, 389, -11
3F562083 ,                        \ 131, 392, -11
3F562881 ,                        \ 129, 394, -11
3F56347E ,                        \ 126, 397, -11
3F56407B ,                        \ 123, 400, -11
3F564879 ,                        \ 121, 402, -11
3F465876 ,                        \ 118, 406, -12
3F466074 ,                        \ 116, 408, -12
3F466872 ,                        \ 114, 410, -12
3F46746F ,                        \ 111, 413, -12
3F467C6D ,                        \ 109, 415, -12
3F46846B ,                        \ 107, 417, -12
3F468C69 ,                        \ 105, 419, -12
3F469866 ,                        \ 102, 422, -12
3F46A064 ,                        \ 100, 424, -12
3F46AC61 ,                        \  97, 427, -12
3F46B45F ,                        \  95, 429, -12
3F46BC5D ,                        \  93, 431, -12
3F46C45B ,                        \  91, 433, -12
3F46CC59 ,                        \  89, 435, -12
3F36DC56 ,                        \  86, 439, -13
3F36E454 ,                        \  84, 441, -13
3F36EC52 ,                        \  82, 443, -13
3F36F450 ,                        \  80, 445, -13
3F36FC4E ,                        \  78, 447, -13
3F37004D ,                        \  77, 448, -13
3F370C4A ,                        \  74, 451, -13
3F371448 ,                        \  72, 453, -13
3F371C46 ,                        \  70, 455, -13
3F372444 ,                        \  68, 457, -13
3F372C42 ,                        \  66, 459, -13
3F373440 ,                        \  64, 461, -13
3F37383F ,                        \  63, 462, -13
3F37403D ,                        \  61, 464, -13
3F37483B ,                        \  59, 466, -13
3F375039 ,                        \  57, 468, -13
3F375438 ,                        \  56, 469, -13
3F375C36 ,                        \  54, 471, -13
3F376434 ,                        \  52, 473, -13
3F376833 ,                        \  51, 474, -13
3F377031 ,                        \  49, 476, -13
3F377430 ,                        \  48, 477, -13
3F377C2E ,                        \  46, 479, -13
3F37842C ,                        \  44, 481, -13
3F37882B ,                        \  43, 482, -13
3F47882A ,                        \  42, 482, -12
3F479028 ,                        \  40, 484, -12
3F479427 ,                        \  39, 485, -12
3F479C25 ,                        \  37, 487, -12
3F47A024 ,                        \  36, 488, -12
3F47A822 ,                        \  34, 490, -12
3F47AC21 ,                        \  33, 491, -12
3F47B020 ,                        \  32, 492, -12
3F57B01F ,                        \  31, 492, -11
3F57B81D ,                        \  29, 494, -11
3F57BC1C ,                        \  28, 495, -11
3F57C01B ,                        \  27, 496, -11
3F57C41A ,                        \  26, 497, -11
3F67C818 ,                        \  24, 498, -10
3F67CC17 ,                        \  23, 499, -10
3F67D016 ,                        \  22, 500, -10
3F67D415 ,                        \  21, 501, -10
3F67D814 ,                        \  20, 502, -10
3F77D813 ,                        \  19, 502,  -9
3F77DC12 ,                        \  18, 503,  -9
3F77E011 ,                        \  17, 504,  -9
3F87E010 ,                        \  16, 504,  -8
3F87E40F ,                        \  15, 505,  -8
3F87E80E ,                        \  14, 506,  -8
3F97E80D ,                        \  13, 506,  -7
3F97EC0C ,                        \  12, 507,  -7
3F97F00B ,                        \  11, 508,  -7
3FA7F00A ,                        \  10, 508,  -6
3FA7F409 ,                        \   9, 509,  -6
3FB7F408 ,                        \   8, 509,  -5
3FB7F408 ,                        \   8, 509,  -5
3FC7F806 ,                        \   6, 510,  -4
3FC7F806 ,                        \   6, 510,  -4
3FD7F805 ,                        \   5, 510,  -3
3FD7FC04 ,                        \   4, 511,  -3
3FE7FC03 ,                        \   3, 511,  -2
3FE7FC03 ,                        \   3, 511,  -2
3FF7FC02 ,                        \   2, 511,  -1
3FF7FC02 ,                        \   2, 511,  -1
0007FC01 ,                        \   1, 511,   0
0007FC01 ,                        \   1, 511,   0
0007FC01 ,                        \   1, 511,   0
0027FFFF ,                        \  -1, 511,   2
0027FFFF ,                        \  -1, 511,   2
0037FFFE ,                        \  -2, 511,   3
0037FFFE ,                        \  -2, 511,   3
0047FFFD ,                        \  -3, 511,   4
0047FBFE ,                        \  -2, 510,   4
0057FBFD ,                        \  -3, 510,   5
0067FBFC ,                        \  -4, 510,   6
0077F7FC ,                        \  -4, 509,   7
0077F7FC ,                        \  -4, 509,   7
0087F7FB ,                        \  -5, 509,   8
0097F3FB ,                        \  -5, 508,   9
00A7F3FA ,                        \  -6, 508,  10
00B7EFFA ,                        \  -6, 507,  11
00C7EBFA ,                        \  -6, 506,  12
00D7EBF9 ,                        \  -7, 506,  13
00E7E7F9 ,                        \  -7, 505,  14
00F7E3F9 ,                        \  -7, 504,  15
0107E3F8 ,                        \  -8, 504,  16
0117DFF8 ,                        \  -8, 503,  17
0127DBF8 ,                        \  -8, 502,  18
0137DBF7 ,                        \  -9, 502,  19
0147D7F7 ,                        \  -9, 501,  20
0157D3F7 ,                        \  -9, 500,  21
0167CFF7 ,                        \  -9, 499,  22
0177CBF7 ,                        \  -9, 498,  23
0197C7F6 ,                        \ -10, 497,  25
01A7C3F6 ,                        \ -10, 496,  26
01B7BFF6 ,                        \ -10, 495,  27
01C7BBF6 ,                        \ -10, 494,  28
01E7B3F6 ,                        \ -10, 492,  30
01F7B3F5 ,                        \ -11, 492,  31
0207AFF5 ,                        \ -11, 491,  32
0217ABF5 ,                        \ -11, 490,  33
0237A3F5 ,                        \ -11, 488,  35
02479FF5 ,                        \ -11, 487,  36
026797F5 ,                        \ -11, 485,  38
027793F5 ,                        \ -11, 484,  39
02978BF5 ,                        \ -11, 482,  41
02A78BF4 ,                        \ -12, 482,  42
02B787F4 ,                        \ -12, 481,  43
02D77FF4 ,                        \ -12, 479,  45
02F777F4 ,                        \ -12, 477,  47
030773F4 ,                        \ -12, 476,  48
03276BF4 ,                        \ -12, 474,  50
033767F4 ,                        \ -12, 473,  51
03575FF4 ,                        \ -12, 471,  53
037757F4 ,                        \ -12, 469,  55
038753F4 ,                        \ -12, 468,  56
03A74BF4 ,                        \ -12, 466,  58
03C743F4 ,                        \ -12, 464,  60
03E73BF4 ,                        \ -12, 462,  62
040737F3 ,                        \ -13, 461,  64
04272FF3 ,                        \ -13, 459,  66
044727F3 ,                        \ -13, 457,  68
04671FF3 ,                        \ -13, 455,  70
048717F3 ,                        \ -13, 453,  72
04A70FF3 ,                        \ -13, 451,  74
04C703F4 ,                        \ -12, 448,  76
04D6FFF4 ,                        \ -12, 447,  77
04F6F7F4 ,                        \ -12, 445,  79
0516EFF4 ,                        \ -12, 443,  81
0536E7F4 ,                        \ -12, 441,  83
0556DFF4 ,                        \ -12, 439,  85
0586CFF5 ,                        \ -11, 435,  88
05A6C7F5 ,                        \ -11, 433,  90
05C6BFF5 ,                        \ -11, 431,  92
05F6B7F4 ,                        \ -12, 429,  95
0616AFF4 ,                        \ -12, 427,  97
0636A3F5 ,                        \ -11, 424,  99
06569BF5 ,                        \ -11, 422, 101
06868FF5 ,                        \ -11, 419, 104
06A687F5 ,                        \ -11, 417, 106
06C67FF5 ,                        \ -11, 415, 108
06E677F5 ,                        \ -11, 413, 110
07166BF5 ,                        \ -11, 410, 113
073663F5 ,                        \ -11, 408, 115
07665BF4 ,                        \ -12, 406, 118
07964BF5 ,                        \ -11, 402, 121
07B643F5 ,                        \ -11, 400, 123
07D637F6 ,                        \ -10, 397, 125
08062BF6 ,                        \ -10, 394, 128
082623F6 ,                        \ -10, 392, 130
085617F6 ,                        \ -10, 389, 133
08760FF6 ,                        \ -10, 387, 135
08B603F5 ,                        \ -11, 384, 139
08D5F7F6 ,                        \ -10, 381, 141
0905EBF6 ,                        \ -10, 378, 144
0925E3F6 ,                        \ -10, 376, 146
0955D3F7 ,                        \  -9, 372, 149
0985C7F7 ,                        \  -9, 369, 152
09A5BFF7 ,                        \  -9, 367, 154
09D5B3F7 ,                        \  -9, 364, 157
0A05ABF6 ,                        \ -10, 362, 160
0A359BF7 ,                        \  -9, 358, 163
0A658FF7 ,                        \  -9, 355, 166
0A9587F6 ,                        \ -10, 353, 169
0AB57BF7 ,                        \  -9, 350, 171
0AE56FF7 ,                        \  -9, 347, 174
0B1563F7 ,                        \  -9, 344, 177
0B455BF6 ,                        \ -10, 342, 180
0B754BF7 ,                        \  -9, 338, 183
0BA53FF7 ,                        \  -9, 335, 186
0BD533F7 ,                        \  -9, 332, 189
0C0523F8 ,                        \  -8, 328, 192
0C251BF8 ,                        \  -8, 326, 194
0C550FF8 ,                        \  -8, 323, 197
0C9503F7 ,                        \  -9, 320, 201
0CC4F7F7 ,                        \  -9, 317, 204
0CF4EBF7 ,                        \  -9, 314, 207
0D24DBF8 ,                        \  -8, 310, 210
0D54CFF8 ,                        \  -8, 307, 213
0D84C3F8 ,                        \  -8, 304, 216
0DB4BBF7 ,                        \  -9, 302, 219
0DE4AFF7 ,                        \  -9, 299, 222
0E149FF8 ,                        \  -8, 295, 225
0E4493F8 ,                        \  -8, 292, 228
0E7483F9 ,                        \  -7, 288, 231
0EA477F9 ,                        \  -7, 285, 234
0ED46BF9 ,                        \  -7, 282, 237
0F045FF9 ,                        \  -7, 279, 240
0F4453F8 ,                        \  -8, 276, 244
0F7447F8 ,                        \  -8, 273, 247
0FA43BF8 ,                        \  -8, 270, 250
0FD42BF9 ,                        \  -7, 266, 253
10041FF9 ,                        \  -7, 263, 256

: filter-taps
   h# 100 0  do
      i h# 400 or  h# 94 dc!
      hfilter i 3 lshift +  dup l@ h# 98 dc!  la1+ l@ h# 9c dc!
   loop

   h# 100 0  do
      i   h# 94 dc!
      vfilter i la+ l@  h# 98 dc!
   loop
;

: vga-mode-msrs
   2000.0000.000f.ff80. 1000.0020 msr!  \ Shrink low mem from 1M to 80000
   2000.0000.080f.ffe0. 1000.0026 msr!  \ Add back 80000-9ffff
   2000.0000.0c0f.ffc0. 1000.0027 msr!  \ Add back c0000-fffff
   8000.0000.0a0f.ffe0. 1000.0021 msr!  \ Enable VGA frame buffer

   8000.0000.3c0f.ffe0. 1000.00e0 msr!  \ Enable VGA I/O regs

   0101.0101.0101.0101. 0000.180b msr!  \ Uncache frame buffer
   \ 1919.1919.1919.1919. 0000.180b msr!  \ Write-burstable frame buffer
;

: all-off
   unlock
   4 dc@ 2000.00e0 invert and 4 dc! \ Compr. line buf (2000.0000), Video (8), Color cursor (4), Cursor (2)
   8 dc@ 1 invert and 8 dc!   \ Timing generator
   1 ms                       \ Let memory accesses finish
   4 dc@ 1 invert and 4 dc!   \ Turn off FIFO load
; 
: 8bpp  c200.0019 8 dc!  ;  \ drop down to 8bpp mode
: vga-start
   8 dc@ 1 or 8 dc!         \ Timing generator
   4 dc@ 40080 or  4 dc!    \ VGA mode (80), VGA Fixed Timing (40000)
;

: display-lfb  ( -- )  5601 4 dc!  ;  \ Enable linear framebuffer

: setup-filter-mode3

\   d# 400 1-  d# 640 1-  wljoin  h# 5c dc!
   d# 400 1-  d# 720 1-  wljoin  h# 5c dc!

   1c802666 90 dc!
\   1c802222 90 dc!
\   30003000 90 dc!
   filter-taps
\   1aaa3000 90 dc!
;
: setup-filter-mode12

\   d# 400 1-  d# 640 1-  wljoin  h# 5c dc!
   d# 480 1-  d# 640 1-  wljoin  h# 5c dc!

   22222222 90 dc!
\   1c802222 90 dc!
\   30003000 90 dc!
   filter-taps
\   1aaa3000 90 dc!
;
: filteron  1000 94 dc!  ;
: filteroff
  40004000 90 dc!  
  000 94 dc!
;

\ XXX get these from video/common/defer.fth
\ false instance value 6-bit-primaries?	\ Indicate if DAC only supports 6bpp
\ defer ext-textmode  ' noop to ext-textmode
\ These are just to make vga.fth happy.  They are ba
\ defer rs@   defer rs!
\ defer idac@ defer idac!
\ defer xvideo-on
\ From graphics.fth

: ext-textmode ;
defer rmr@  defer rmr!

: (set-colors)  ( adr index #indices -- )
   swap windex!
   3 *  bounds  ?do  i c@  plt!  loop
;

fload ${BP}/dev/video/controlr/vga.fth
fload ${BP}/dev/video/common/textmode.fth

0 value pc-font-adr
: (pc-font)  ( -- fontparams )
   pc-font-adr 0=  if
      " pcfont" " find-drop-in" evaluate  if  ( adr len )
         drop to pc-font-adr
      else
         default-font exit
      then
   then

   " /packages/terminal-emulator" find-package  if  ( phandle )
      " decode-font" rot find-method  if   ( xt )
         pc-font-adr swap execute          ( font-params )
         exit
      then
   then

   \ Fallback
   default-font
;
' (pc-font) to pc-font

: switch-to-vga-mode3  ( -- )
   vga-mode-msrs

   \ The filter must be turned on before turning on the VGA,
   \ otherwise the filter and the VGA don't synchronize to the
   \ frame and the sequencer shuts off after one frame.
   \ That can be fixed with all-off vga-start
   setup-filter-mode3 filteron

   all-off  8bpp  vga-start
   use-vga-dac
   ['] gxvideo-on to video-on        \ Install Geode-specific video-on routine
;
: switch-to-vga-mode12  ( -- )
   vga-mode-msrs

   \ The filter must be turned on before turning on the VGA,
   \ otherwise the filter and the VGA don't synchronize to the
   \ frame and the sequencer shuts off after one frame.
   \ That can be fixed with all-off vga-start
\   filteroff
   setup-filter-mode12 filteron

   all-off  8bpp  vga-start
   use-vga-dac
   ['] gxvideo-on to video-on        \ Install Geode-specific video-on routine
;

warning @ warning off
: text-mode3  ( -- )
   switch-to-vga-mode3  text-mode3
   h# ff h# e crt!  h# ff h# f crt!  \ Move the hardware cursor off-screen
;
: graphics-mode12  ( -- )
   switch-to-vga-mode12  graphics-mode12
;
warning !

\ LICENSE_BEGIN
\ Copyright (c) 2007 FirmWorks
\ 
\ Permission is hereby granted, free of charge, to any person obtaining
\ a copy of this software and associated documentation files (the
\ "Software"), to deal in the Software without restriction, including
\ without limitation the rights to use, copy, modify, merge, publish,
\ distribute, sublicense, and/or sell copies of the Software, and to
\ permit persons to whom the Software is furnished to do so, subject to
\ the following conditions:
\ 
\ The above copyright notice and this permission notice shall be
\ included in all copies or substantial portions of the Software.
\ 
\ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
\ EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
\ MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
\ NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
\ LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
\ OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
\ WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
\
\ LICENSE_END

